# 故障排除指南

## 常见问题及解决方案

### 1. 应用启动问题

#### 问题：应用无法启动
**症状**: 双击应用图标无反应，或启动后立即崩溃
**可能原因**:
- Node.js版本不兼容
- 依赖包缺失或损坏
- 数据库文件损坏
- 权限问题

**解决方案**:
```bash
# 1. 检查Node.js版本
node --version  # 需要16.0+

# 2. 重新安装依赖
rm -rf node_modules package-lock.json
npm install

# 3. 清理数据库（谨慎操作）
# 删除 %APPDATA%/learnEnglishV2/learn_english.db

# 4. 以管理员身份运行
```

#### 问题：端口被占用
**症状**: 开发模式下提示端口5173被占用
**解决方案**:
```bash
# 查看端口占用
netstat -ano | findstr :5173

# 杀死占用进程
taskkill /PID <进程ID> /F

# 或者修改vite.config.js中的端口配置
```

### 2. 数据库问题

#### 问题：数据库连接失败
**症状**: 应用启动时提示数据库错误
**可能原因**:
- 数据库文件路径错误
- 数据库文件损坏
- 权限不足

**解决方案**:
```javascript
// 检查数据库路径
console.log('数据库路径:', app.getPath('userData'))
// 默认路径: %APPDATA%/learnEnglishV2/learn_english.db

// 重新初始化数据库
// 删除数据库文件，重启应用
```

#### 问题：数据丢失
**症状**: 单词数据或设置丢失
**解决方案**:
```bash
# 1. 检查数据库文件是否存在
# 2. 备份数据库文件
# 3. 重新初始化数据
```

### 3. 学习功能问题

#### 问题：复习弹框不出现
**症状**: 启动学习模式后，复习弹框不弹出
**可能原因**:
- 调度器未正常启动
- 没有待复习的单词
- 时间间隔设置问题

**解决方案**:
```javascript
// 1. 检查调度器状态
const status = await window.electronAPI.getSchedulerStatus()
console.log('调度器状态:', status)

// 2. 检查待复习单词
const words = await window.electronAPI.getAllWords()
const readyWords = words.filter(w => new Date(w.nextReviewTime) <= new Date())
console.log('待复习单词:', readyWords)

// 3. 重置复习时间
await window.electronAPI.resetWordsReviewTime()
```

#### 问题：复习时间间隔不准确
**症状**: 复习弹框出现时间与设定间隔不符
**解决方案**:
```javascript
// 检查设置是否正确保存
// 检查调度器是否正确读取设置
// 重启学习模式
```

#### 问题：熟练度不更新
**症状**: 答对单词后熟练度没有增加
**解决方案**:
```javascript
// 1. 检查数据库更新是否成功
// 2. 检查界面刷新是否正常
// 3. 手动刷新单词列表
```

### 4. 界面问题

#### 问题：复习弹框显示异常
**症状**: 弹框样式错乱，文字显示不全
**可能原因**:
- CSS样式冲突
- 窗口大小设置问题
- 系统DPI缩放问题

**解决方案**:
```javascript
// 1. 检查窗口配置
// 2. 调整窗口大小
// 3. 检查CSS样式
```

#### 问题：主界面不响应
**症状**: 主界面按钮点击无反应
**可能原因**:
- Vue组件未正确挂载
- 事件监听器失效
- IPC通信问题

**解决方案**:
```javascript
// 1. 检查Vue开发者工具
// 2. 检查控制台错误
// 3. 重启应用
```

### 5. 系统托盘问题

#### 问题：系统托盘图标不显示
**症状**: 启动学习模式后托盘图标未出现
**可能原因**:
- 系统托盘功能被禁用
- 图标文件路径错误
- 权限问题

**解决方案**:
```javascript
// 1. 检查托盘设置
// 2. 检查图标文件路径
// 3. 以管理员身份运行
```

#### 问题：托盘菜单不响应
**症状**: 右键托盘图标菜单无反应
**解决方案**:
```javascript
// 检查托盘事件监听器
// 检查菜单项配置
```

### 6. 性能问题

#### 问题：应用运行缓慢
**症状**: 界面响应慢，操作卡顿
**可能原因**:
- 数据库查询效率低
- 内存泄漏
- 定时器未清理

**解决方案**:
```javascript
// 1. 优化数据库查询
// 2. 检查内存使用
// 3. 清理定时器
```

#### 问题：内存占用过高
**症状**: 应用内存使用持续增长
**解决方案**:
```javascript
// 1. 检查定时器清理
// 2. 检查事件监听器清理
// 3. 重启应用
```

## 调试工具

### 1. 开发者工具
```javascript
// 打开开发者工具
window.electronAPI.openDevTools()
```

### 2. 日志查看
```bash
# 查看应用日志
# Windows: 事件查看器
# macOS: Console.app
# Linux: journalctl
```

### 3. 数据库检查
```javascript
// 使用测试脚本检查数据库
node tests/check-db.js
```

## 预防措施

### 1. 定期备份
- 定期备份数据库文件
- 备份用户设置
- 备份单词数据

### 2. 版本管理
- 使用Git进行版本控制
- 记录重要更改
- 测试新功能

### 3. 错误监控
- 添加错误日志
- 监控应用性能
- 用户反馈收集

## 联系支持

如果遇到无法解决的问题，请提供以下信息：
1. 操作系统版本
2. Node.js版本
3. 应用版本
4. 错误日志
5. 问题复现步骤
6. 期望行为描述 